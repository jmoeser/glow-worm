<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{% block title %}Glow Worm{% endblock %}</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://unpkg.com/htmx.org@2.0.4"></script>
        <link rel="stylesheet" href="/static/styles.css" />
        <link rel="icon" type="image/svg+xml" href="/static/logo.svg" />
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                document.body.addEventListener(
                    "htmx:configRequest",
                    function (event) {
                        const method = event.detail.verb.toUpperCase();
                        if (method !== "GET") {
                            const match = document.cookie.match(
                                /(?:^|;\s*)csrftoken=([^;]*)/,
                            );
                            if (match) {
                                event.detail.headers["x-csrftoken"] =
                                    decodeURIComponent(match[1]);
                            }
                        }
                    },
                );

                // Set active nav link
                const path = window.location.pathname;
                document.querySelectorAll('.gw-nav a').forEach(function(link) {
                    const href = link.getAttribute('href');
                    if (href === '/' && path === '/') {
                        link.classList.add('active');
                    } else if (href !== '/' && path.startsWith(href)) {
                        link.classList.add('active');
                    }
                });
            });
        </script>
    </head>
    <body>
        <nav class="gw-sidebar">
            <div class="gw-logo">
                <div class="gw-logo-text">
                    <img src="/static/logo.svg" class="gw-logo-icon" alt="Glow Worm" />
                    Glow Worm
                </div>
            </div>
            <ul class="gw-nav">
                <li>
                    <a href="/">
                        <svg class="gw-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
                        Dashboard
                    </a>
                </li>
                <li>
                    <a href="/income">
                        <svg class="gw-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                        Income
                    </a>
                </li>
                <li>
                    <a href="/budgets">
                        <svg class="gw-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"/><path d="M3 5v14a2 2 0 0 0 2 2h16v-5"/><path d="M18 12a2 2 0 0 0 0 4h4v-4Z"/></svg>
                        Budgets
                    </a>
                </li>
                <li>
                    <a href="/transactions">
                        <svg class="gw-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3v18"/><path d="m12 18 5 3 5-3"/><path d="M7 21V3"/><path d="m12 6-5-3-5 3"/></svg>
                        Transactions
                    </a>
                </li>
                <li>
                    <a href="/sinking-funds">
                        <svg class="gw-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2"/><path d="M2 9v1c0 1.1.9 2 2 2h1"/><circle cx="16" cy="11" r="1"/></svg>
                        Sinking Funds
                    </a>
                </li>
                <li>
                    <a href="/bills">
                        <svg class="gw-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z"/><path d="M8 7h8"/><path d="M8 11h8"/><path d="M8 15h5"/></svg>
                        Bills
                    </a>
                </li>
                <li>
                    <a href="/users">
                        <svg class="gw-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="5"/><path d="M20 21a8 8 0 0 0-16 0"/></svg>
                        Users
                    </a>
                </li>
            </ul>
            <div class="gw-sidebar-footer">
                <p class="gw-username">{{ username }}</p>
                <a href="/logout">Sign out</a>
            </div>
        </nav>
        <main class="gw-main">{% block content %}{% endblock %}</main>
    </body>
</html>
